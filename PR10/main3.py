import json
import matplotlib.pyplot as plt
from collections import defaultdict

JSON_DATA_STRING = """
[
    { "Прізвище": "Коваленко", "Оцінки": { "Математика": 10, "Історія": 11, "Фізика": 9, "Інформатика": 12, "Англійська": 10 } },
    { "Прізвище": "Петренко", "Оцінки": { "Математика": 8, "Історія": 9, "Фізика": 7, "Інформатика": 10, "Англійська": 8 } },
    { "Прізвище": "Іванов", "Оцінки": { "Математика": 12, "Історія": 12, "Фізика": 12, "Інформатика": 12, "Англійська": 12 } },
    { "Прізвище": "Сидорова", "Оцінки": { "Математика": 11, "Історія": 10, "Фізика": 11, "Інформатика": 9, "Англійська": 11 } },
    { "Прізвище": "Мельник", "Оцінки": { "Математика": 7, "Історія": 8, "Фізика": 6, "Інформатика": 7, "Англійська": 7 } },
    { "Прізвище": "Шевченко", "Оцінки": { "Математика": 10, "Історія": 10, "Фізика": 10, "Інформатика": 10, "Англійська": 10 } },
    { "Прізвище": "Олексієнко", "Оцінки": { "Математика": 9, "Історія": 8, "Фізика": 9, "Інформатика": 8, "Англійська": 9 } },
    { "Прізвище": "Бойко", "Оцінки": { "Математика": 11, "Історія": 11, "Фізика": 10, "Інформатика": 11, "Англійська": 11 } },
    { "Прізвище": "Зайцев", "Оцінки": { "Математика": 9, "Історія": 9, "Фізика": 9, "Інформатика": 9, "Англійська": 9 } },
    { "Прізвище": "Гриценко", "Оцінки": { "Математика": 6, "Історія": 7, "Фізика": 6, "Інформатика": 7, "Англійська": 6 } },
    { "Прізвище": "0", "Оцінки": { "Математика": 2, "Історія": 2, "Фізика": 2, "Інформатика": 2, "Англійська": 2 } }
]
"""

data = json.loads(JSON_DATA_STRING)
subject_totals = defaultdict(int)
for student in data:
    for subject, grade in student.get("Оцінки", {}).items():
        subject_totals[subject] += grade
labels = list(subject_totals.keys())
sizes = list(subject_totals.values())
colors = ['#ff9999', '#66b3ff', '#99ff99', '#ffcc99', '#c2c2f0']
plt.figure(figsize=(10, 8))
plt.pie(
    sizes, 
    labels=labels, 
    colors=colors, 
    autopct='%1.1f%%',
    startangle=90, 
    wedgeprops={'edgecolor': 'black', 'linewidth': 1})
plt.axis('equal') 
plt.title('Відсотковий розподіл суми оцінок за предметами (Практична №9)', fontsize=14)
plt.savefig('task3_pie_chart.png')
print("Кругову діаграму збережено як 'task3_pie_chart.png'")